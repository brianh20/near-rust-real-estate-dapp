(this["webpackJsonpsecret-safe-react"]=this["webpackJsonpsecret-safe-react"]||[]).push([[0],{105:function(e,t){},133:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){"use strict";n.r(t);var r=n(3),c=n(11),a=n(6),s=n(0),o=n(67),i=n.n(o),u=n(18),l=n(70),p=n(14),b=(n(133),n(19)),d=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t,n){var a,s,o;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.b)(t,"get_secrets","{}");case 2:if(a=e.sent.map((function(e){return JSON.parse(e)})),e.t1=n,!e.t1){e.next=8;break}return e.next=7,Object(b.b)(t,"get_secrets_by_asker",'{"asker": "'.concat(n,'"}'));case 7:e.t1=e.sent.map((function(e){return JSON.parse(e).id}));case 8:if(e.t0=e.t1,e.t0){e.next=11;break}e.t0=[];case 11:if(s=e.t0,o=[],!a){e.next=18;break}return o=a.reverse().map((function(e){return Object(c.a)(Object(c.a)({},e),{},{visible:s.includes(e.id),owned:e.owner===n,price:parseFloat(e.price/1e5)})})),e.abrupt("return",o);case 18:console.log("Oof, there aren't any secrets.");case 19:return e.abrupt("return",o);case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),j=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t,n,c){var a,s,o,i;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.title,s=c.content,o=c.price,e.prev=1,e.next=4,n.account().functionCall({contractId:t.contractName,methodName:"store_secret",args:{title:a,content:s,price:o},gas:b.a,attachedDeposit:0,walletMeta:"",walletCallbackUrl:""});case 4:(i=e.sent)&&i.transaction&&i.transaction.hash&&console.log("Transaction hash for explorer",i.transaction.hash),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("Something went wrong!",e.t0);case 11:return e.prev=11,e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(t,n,r){return e.apply(this,arguments)}}(),f=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t,n,c){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.b)(t,"get_secret_by_asker_by_id",'{"asker": "'.concat(n,'", "_key":"').concat(c,'"}'));case 2:if(!(a=e.sent)){e.next=7;break}return e.abrupt("return",a);case 7:console.log("Oof, looks like you don't have access.");case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),O=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t,n,c,a){var s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.account().functionCall({contractId:t.contractName,methodName:"buy_secret",args:{_key:String(c)},gas:b.a,attachedDeposit:"".concat(Math.round(1e5*a),"0000000000000000000"),walletMeta:"",walletCallbackUrl:""});case 3:(s=e.sent)&&s.transaction&&s.transaction.hash&&console.log("Transaction hash for explorer",s.transaction.hash),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Something went wrong!",e.t0);case 10:return e.prev=10,e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t,n,r,c){return e.apply(this,arguments)}}(),h=n(68),v=n(2),x={sentences:["Transaction processing\u2026"],loaderType:"fire",loaderSize:"big",color:"#f2f2f2",textStyles:{fontSize:19,fontWeight:"bold",height:"6em",color:"#f2f2f2"},wrapperBackgroundColor:"linear-gradient(to bottom, #f2f2f2 0%, #111111 100%)",counter:!1,counterMax:5,counterDelay:3e3,counterChars:null,counterStyles:{color:"white"},fadeIn:!0,startFadeOut:!1},m=function(e){return Object(v.jsxs)("div",{className:"wrapper",children:[Object(v.jsx)("header",{className:"site-header"}),Object(v.jsx)("main",{className:"main-area",children:Object(v.jsx)(h.a,Object(c.a)(Object(c.a)({},x),e))})]})},w=(n(137),function(e){var t=e.signIn,n=e.signOut,r=e.currentUser;return Object(v.jsx)("div",{id:"user",children:r?Object(v.jsxs)("div",{children:[Object(v.jsx)("span",{children:r}),Object(v.jsx)("button",{onClick:n,children:"Sign out"})]}):Object(v.jsx)("button",{onClick:t,children:"Log in"})})}),g=(n(138),function(e){var t=e.postSecret,n=Object(s.useState)(""),c=Object(p.a)(n,2),o=c[0],i=c[1],u=Object(s.useState)(""),l=Object(p.a)(u,2),b=l[0],d=l[1],j=Object(s.useState)(""),f=Object(p.a)(j,2),O=f[0],h={title:i,content:d,price:f[1]},x=Object(s.useState)(""),m=Object(p.a)(x,2),w=m[0],g=m[1],S=function(){var e=Object(a.a)(Object(r.a)().mark((function e(){var n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.round(1e5*O),o&&b&&n&&!isNaN(n)?(g(""),t({title:o,content:b,price:n})):g("At least one of the fields is incorrect");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(e){h[e.target.name](e.target.value)};return Object(v.jsxs)("div",{id:"new-secret",children:[Object(v.jsxs)("div",{className:"field",children:[Object(v.jsx)("span",{children:"Title:"}),Object(v.jsx)("input",{type:"text",name:"title",onChange:k})]}),Object(v.jsxs)("div",{className:"field",children:[Object(v.jsx)("span",{children:"Content:"}),Object(v.jsx)("input",{type:"text",name:"content",onChange:k})]}),Object(v.jsxs)("div",{className:"field",children:[Object(v.jsx)("span",{children:"Price (N):"}),Object(v.jsx)("input",{type:"number",min:"0",step:"0.00001",name:"price",onChange:k})]}),Object(v.jsxs)("div",{id:"submit",children:[Object(v.jsx)("div",{children:Object(v.jsx)("span",{className:"important",children:w})}),Object(v.jsx)("button",{onClick:S,children:"Add Secret"})]})]})}),S=(n(139),n(140),function(e){var t=e.item,n=e.view,r=e.buy;return Object(v.jsxs)("div",{className:"itemContainer",children:[Object(v.jsxs)("div",{className:"item",children:[Object(v.jsx)("div",{className:"id",children:t.id}),Object(v.jsxs)("div",{className:"title",children:[Object(v.jsx)("span",{children:t.title}),t.owned&&Object(v.jsx)("span",{className:"important",children:"OWN"})]}),!t.visible&&Object(v.jsxs)("div",{className:"price",children:[Object(v.jsx)("b",{children:t.price})," N"]}),Object(v.jsx)("div",{className:"action ".concat(t.visible?"view":"buy"),onClick:function(){return t.visible?n(t.id):r(t.id,t.price)},children:t.visible?"VIEW":"BUY"})]}),t.content&&Object(v.jsx)("div",{className:"itemContent",children:t.content})]})}),k=function(e){var t=e.data,n=e.view,r=e.buy;return Object(v.jsx)("div",{id:"list",children:t&&t.map&&t.map((function(e,t){return Object(v.jsx)(S,{item:e,dix:t,view:n,buy:r},"secret-".concat(t))}))})},N=function(e){var t=e.nearConfig,n=e.walletConnection,o=e.currentUser,i=Object(s.useState)(!1),u=Object(p.a)(i,2),b=u[0],h=u[1],x=Object(s.useState)([]),S=Object(p.a)(x,2),N=S[0],_=S[1];Object(s.useEffect)((function(){C()}),[]);var C=function(){var e=Object(a.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.t0=_,e.next=4,d(t,o);case 4:e.t1=e.sent,(0,e.t0)(e.t1),h(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){!function(e,t){t.requestSignIn(e.contractName,"","","")}(t,n)},E=function(){var e=Object(a.a)(Object(r.a)().mark((function e(c){var a,s,o;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.title,s=c.content,o=c.price,h(!0),e.prev=2,e.next=5,j(t,n,{title:a,content:s,price:o});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),alert(e.t0);case 10:return e.prev=10,h(!1),C(),e.finish(10);case 14:case"end":return e.stop()}}),e,null,[[2,7,10,14]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(a.a)(Object(r.a)().mark((function e(n){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t,o,n);case 2:a=e.sent,_(Object(l.a)(N).map((function(e){return e.id===n?Object(c.a)(Object(c.a)({},e),{},{content:a}):e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(a.a)(Object(r.a)().mark((function e(c,a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=9;break}return h(!0),e.next=4,O(t,n,c,a);case 4:return e.next=6,C();case 6:h(!1),e.next=10;break;case 9:y();case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return b?Object(v.jsx)(m,{}):Object(v.jsxs)("div",{id:"page",children:[Object(v.jsx)(w,{signIn:y,signOut:function(){!function(e){e.signOut(),window.location.reload()}(n)},currentUser:o}),Object(v.jsx)("h1",{children:"NEAR Secret Safe"}),o&&Object(v.jsx)(g,{postSecret:E}),Object(v.jsx)(k,{data:N,view:U,buy:T})]})},_=n(69),C=n.n(_);function y(){return(y=Object(a.a)(Object(r.a)().mark((function e(){var t,n,a,s,o;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=C()(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).NEAR_ENV||"testnet"),n=new u.keyStores.BrowserLocalStorageKeyStore,e.next=4,u.connect(Object(c.a)({keyStore:n},t));case 4:return a=e.sent,(s=new u.WalletConnection(a)).getAccountId()&&(o=s.getAccountId()),e.abrupt("return",{nearConfig:t,walletConnection:s,currentUser:o});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return y.apply(this,arguments)})().then((function(e){var t=e.nearConfig,n=e.walletConnection,r=e.currentUser;i.a.render(Object(v.jsx)(N,{nearConfig:t,walletConnection:n,currentUser:r}),document.getElementById("root"))}))},19:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(3),c=n(6),a=n(18),s=n(44),o=n.n(s),i=n(43),u=new(n.n(i).a)("30000000000000");function l(e,t,n){return p.apply(this,arguments)}function p(){return(p=Object(c.a)(Object(r.a)().mark((function t(n,c,s){var i,u,l,p;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.from(s,"utf8"),u=o.a.encode(i),l=new a.providers.JsonRpcProvider(n.nodeUrl),t.next=5,l.query("call/".concat(n.contractName,"/").concat(c),u);case 5:return p=t.sent,t.abrupt("return",JSON.parse(p.result.map((function(e){return String.fromCharCode(e)})).join("")));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}).call(this,n(13).Buffer)},69:function(e,t){var n=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).CONTRACT_NAME||"ss-6.testnet";e.exports=function(e){switch(e){case"production":case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:n,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org"};case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:n,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:n,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:n};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:n,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:n,masterAccount:"test.near"};default:throw Error("Unconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}},79:function(e,t){},88:function(e,t){}},[[141,1,2]]]);
//# sourceMappingURL=main.5410301b.chunk.js.map